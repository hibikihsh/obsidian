---
title: "【セキュリティ】初めてアプリをつくる人がまず抑えておくべき基本的事項"
source: "https://qiita.com/ktdatascience/items/72ecd89bef963acb9559"
author:
  - "[[ktdatascience]]"
published: 2025-11-15
created: 2025-11-18
description: "はじめに Webアプリケーションを開発する際、セキュリティ対策は避けて通れない重要なテーマです。攻撃者は常に脆弱性を探しており、一度セキュリティホールが悪用されると、個人情報の漏洩やシステムの改ざんなど、深刻な被害につながる可能性があります。 本記事では、Web開発者が最..."
tags:
  - "clippings"
---
![](https://relay-dsp.ad-m.asia/dmp/sync/bizmatrix?pid=c3ed207b574cf11376&d=x18o8hduaj&uid=1932168)

[@ktdatascience](https://qiita.com/ktdatascience)

投稿日

## はじめに

Webアプリケーションを開発する際、セキュリティ対策は避けて通れない重要なテーマです。攻撃者は常に脆弱性を探しており、一度セキュリティホールが悪用されると、個人情報の漏洩やシステムの改ざんなど、深刻な被害につながる可能性があります。

本記事では、Web開発者が最低限知っておくべき代表的な攻撃手法とその対策、さらに開発時のベストプラクティスについて解説します。基本的なセキュリティ知識を身につけることで、より安全なWebアプリケーションを構築できるようになりますね。

## 代表的な攻撃手法と対策

### SQLインジェクション

#### SQLインジェクションとは

SQLインジェクションは、SQLのクエリに悪意のあるコードを挿入し、不正にデータベースを操作する攻撃手法です。攻撃者は入力フォームやURLパラメータなどを通じて、想定外のSQL文を実行させることができます。

#### 攻撃の仕組みと具体例

例えば、ユーザー認証の際に以下のようなSQLクエリが実行されるとします。

```sql
SELECT * FROM users WHERE username = 'admin' --' AND password = 'password';
```

この場合、 `--` はSQLのコメント記号であり、それ以降の部分がコメントアウトされます。その結果、パスワードチェックが無効化され、パスワードを知らなくてもログインできてしまうのです。

#### 対処法

SQLインジェクションを防ぐには、以下の2つの方法が有効です。

**エスケープ処理**

エスケープとは、特殊文字を無害化する処理のことです。シングルクォートやダブルクォートなどのSQL文で特別な意味を持つ文字を、単なる文字列として扱えるように変換します。

**プリペアドステートメント**

プリペアドステートメントは、SQL文の構造とデータを分離して扱う方法で、最も推奨される対策です。この方法では、SQL文のテンプレートを先に準備し、後から値を安全に挿入するため、悪意のあるコードが実行される心配がありません。

### クロスサイトスクリプティング(XSS)

#### XSSとは

クロスサイトスクリプティング(XSS)は、悪意のあるスクリプトをウェブページに挿入し、他のユーザーに実行させる攻撃手法です。ユーザーがフォームやURLにJavaScriptを入力して実行できる状態にあることは、Webサービスとして重大な脆弱性となります。

#### 攻撃の仕組みと具体例

攻撃者は掲示板のコメント欄やプロフィール情報など、ユーザー入力を受け付ける箇所にスクリプトを仕込みます。そのページを閲覧した他のユーザーのブラウザでスクリプトが実行され、クッキー情報の窃取やフィッシングサイトへの誘導などが行われる可能性があります。

#### 対処法

**入力値のエスケープとサニタイズ**

ユーザーからの入力を適切にエスケープ・サニタイズ(無害化)することが重要です。エスケープによって、HTMLやJavaScriptとして解釈される可能性のある文字を、単なるテキストとして表示させることができます。

**フレームワークの自動エスケープ機能**

主要なフレームワークでは、テンプレートエンジンが自動的にエスケープ処理を行うことが多くなっています。ただし、どのような仕様になっているのかを確認してから実装することが大切ですね。自動エスケープが無効になっている箇所や、意図的に生のHTMLを出力する機能を使う際には、特に注意が必要です。

## セキュリティを強化する設定

### クッキーのセキュリティ設定

#### クッキーの基本的な仕組み

クッキーは、クライアント側に保存される小さなデータ片で、セッション管理やユーザー認証に使用されます。サーバーがHTTPレスポンスで `Set-Cookie` ヘッダーを送信し、クライアントはそのクッキーを保存して以降のリクエストで `Cookie` ヘッダーとして送信します。

#### セキュリティ属性

クッキーには、セキュリティを強化するためのいくつかの属性があります。

**HttpOnly属性**

HttpOnly属性を設定すると、JavaScriptからクッキーにアクセスできなくなります。これにより、XSS攻撃によってクッキー情報が盗まれるリスクを大幅に減らすことができます。セッションIDなど、重要な情報を含むクッキーには必ず設定しましょう。

**Secure属性**

Secure属性を設定すると、HTTPS接続でのみクッキーが送信されるようになります。HTTP通信では送信されないため、通信経路上での盗聴を防ぐことができます。

#### 開発環境での注意点

ただし、ローカル開発環境ではHTTPSを使用しないことが多いため、Secure属性を設定すると開発時にクッキーが機能しなくなる場合があります。本番環境と開発環境で設定を切り替えるなど、適切な対応が必要です。

### コンテンツセキュリティポリシー(CSP)

#### CSPとは

コンテンツセキュリティポリシー(CSP)は、ウェブページが読み込むことができるリソースの種類と場所を制限するセキュリティ機能です。XSS攻撃を防ぐのに非常に有効な手段となります。

#### CSPの設定方法

CSPは、HTTPヘッダーまたはHTMLの `<meta>` タグで設定できます。どのドメインからスクリプトを読み込むか、インラインスクリプトを許可するかどうかなど、細かく制御することが可能です。

#### XSS対策としての効果

CSPを適切に設定することで、たとえ攻撃者が悪意のあるスクリプトを挿入できたとしても、ブラウザがそのスクリプトの実行をブロックします。これにより、多層防御の一環として強力な保護を提供できますね。

## 開発時のベストプラクティス

### ライブラリのデフォルト設定を変更する

#### デフォルト設定のリスク

ライブラリやフレームワークのデフォルトの設定や名称は、攻撃者にとって予測しやすいため、セキュリティ上のリスクとなります。多くの開発者がデフォルト設定をそのまま使用しているため、攻撃者はよく知られた脆弱性や設定を狙って攻撃を仕掛けることができるのです。

#### 変更すべき項目

可能な限り、以下のような項目を変更しておきましょう。

- データベースのデフォルトユーザー名
- 管理画面のデフォルトURL
- セッション管理に使用されるクッキー名
- デフォルトのポート番号(可能な場合)

これらの変更により、自動化された攻撃ツールによる総当たり攻撃のリスクを軽減できます。

### 適切なエラーハンドリング

#### 詳細なエラー情報を隠す理由

詳細なエラーメッセージは、攻撃者にシステムの内部情報を提供する可能性があります。例えば、データベースのテーブル構造やファイルパス、使用しているライブラリのバージョンなどが漏れると、攻撃の手がかりになってしまいます。

#### 本番環境と開発環境での対応の違い

ユーザーには一般的なエラーメッセージを表示し、詳細なエラー情報はサーバー側のログに記録するようにします。本番環境では、スタックトレースや内部エラーの詳細を表示しないような設定にしましょう。

一方、開発環境では、デバッグのために詳細なエラー情報が必要です。環境変数などを利用して、本番と開発で適切に設定を切り替えることが重要ですね。

#### ログへの記録方法

エラーログには、トラブルシューティングに必要な情報を含めつつ、個人情報やパスワードなどの機密情報は記録しないよう注意します。ログファイル自体も適切なアクセス権限で保護し、権限のないユーザーからアクセスできないようにしておきましょう。

## まとめ

### セキュリティ対策のチェックリスト

Webアプリケーションのセキュリティを確保するために、以下のポイントを確認しましょう。

- SQLインジェクション対策としてプリペアドステートメントを使用している
- XSS対策として入力値を適切にエスケープ・サニタイズしている
- クッキーにHttpOnly属性とSecure属性を設定している
- CSPを導入してリソースの読み込みを制限している
- ライブラリのデフォルト設定を変更している
- 本番環境で詳細なエラー情報を表示しない設定にしている

### 継続的な学習の重要性

セキュリティの世界は常に進化しており、新しい攻撃手法や脆弱性が日々発見されています。本記事で紹介した対策は基本的なものであり、これだけで完全に安全とは言えません。

定期的にセキュリティ関連の情報をキャッチアップし、使用しているライブラリやフレームワークを最新の状態に保つことが大切です。また、セキュリティテストやコードレビューを実施し、継続的にアプリケーションの安全性を向上させていきましょう。

セキュリティ対策は一度行えば終わりではなく、継続的な取り組みが必要です。基本をしっかり押さえつつ、常に学び続ける姿勢を持つことで、より安全なWebアプリケーションを開発できるようになりますね。

[0](https://qiita.com/ktdatascience/items/#comments)

コメント一覧へ移動

X（Twitter）でシェアする

Facebookでシェアする

はてなブックマークに追加する

## Qiita Advent Calendar 開催！

[79](https://qiita.com/ktdatascience/items/72ecd89bef963acb9559/likers)

いいねしたユーザー一覧へ移動

73